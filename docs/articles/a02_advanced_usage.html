<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced Usage • timeseriesdb</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Advanced Usage">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">timeseriesdb</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01_basic_usage.html">Basic Usage</a>
    </li>
    <li>
      <a href="../articles/a02_advanced_usage.html">Advanced Usage</a>
    </li>
    <li>
      <a href="../articles/a03_admin_usage.html">Admin Usage</a>
    </li>
    <li>
      <a href="../articles/developer_doc.html">timeseriesdb Developer Documentation</a>
    </li>
    <li>
      <a href="../articles/installation_guide.html">Installation Guide</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mbannert/timeseriesdb">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Advanced Usage</h1>
                        <h4 class="author">Matthias Bannert and Severin Thöni</h4>
            
            <h4 class="date">2020-07-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mbannert/timeseriesdb/blob/master/vignettes/a02_advanced_usage.Rmd"><code>vignettes/a02_advanced_usage.Rmd</code></a></small>
      <div class="hidden name"><code>a02_advanced_usage.Rmd</code></div>

    </div>

    
    
<div id="starting-point" class="section level2">
<h2 class="hasAnchor">
<a href="#starting-point" class="anchor"></a>Starting Point</h2>
<p>We assume you are past the basics and R, {timeseriesdb} and PostgreSQL are up and running. (<em>For the remainder of this guide we assume PostgreSQL runs on a local docker container accessible via port 1111.</em>)</p>
</div>
<div id="versioning-of-time-series-vintages" class="section level2">
<h2 class="hasAnchor">
<a href="#versioning-of-time-series-vintages" class="anchor"></a>Versioning of Time Series (Vintages)</h2>
<p>A core feature of {timeseriesdb} is the ability to store vintages, i.e., different versions of time series. The package was created with official and economic statistics in mind, so data revisions and the ability to evaluate forecasts plays an important role in the package design. Hence {timeseriesdb} versions every time series it stores by default.</p>
<p>Let’s assume <code>ts1_may</code> is a time series published in May 2020 and <code>ts1_june</code> is yet another version of the very same time series.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(kofdata)</a></code></pre></div>
<pre><code>## Loading required package: jsonlite</code></pre>
<pre><code>## Loading required package: httr</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">tsl &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/kofdata/man/get_time_series.html">get_time_series</a></span>(<span class="st">"ch.kof.barometer"</span>)</a></code></pre></div>
</div>
<div id="datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#datasets" class="anchor"></a>Datasets</h2>
<p>All time series have to belong to a previously created dataset. New datasets can</p>
<p>To see all keys registered in a dataset simply call:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="../reference/db_get_dataset_keys.html">db_get_dataset_keys</a></span>(con, <span class="st">"ch.zrh_airport"</span>, <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a></code></pre></div>
<p>To do the opposite, that is, find out which dataset series are assigned to, run:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/db_get_dataset_id.html">db_get_dataset_id</a></span>(con, <span class="st">"ch.zrh_airport.arrival.total"</span>,</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">                  <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a></code></pre></div>
<p>With <a href="">db_read_time_series_dataset()</a> you can read all time series from a given dataset.</p>
</div>
<div id="release-management" class="section level2">
<h2 class="hasAnchor">
<a href="#release-management" class="anchor"></a>Release Management</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">db_list_releases</span>(con, <span class="dt">include_past =</span> T, <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a></code></pre></div>
<p>Cancelling a future release is simply a matter of calling <a href="">db_cancel_release()</a>. Cancellation of past releases is not possible, but release can be updated with <a href="">db_update_release()</a>. Also you can easily query the latest release</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">db_get_latest_release_for_set</span>(con, <span class="st">"ch.zrh_airport"</span>,<span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a></code></pre></div>
<p>Similarily use <a href="">db_get_next_release_for_set()</a> to get the next upcoming release.</p>
</div>
<div id="collections" class="section level2">
<h2 class="hasAnchor">
<a href="#collections" class="anchor"></a>Collections</h2>
<p>Collections are another concept introduced in v1.0. Collections are user specific compositions of time series identifiers. Users of earlier versions of time series may think of this functionality as ‘sets’. To avoid any confusion, let’s be clear about the new terminology here:</p>
<ul>
<li><p>datasets = registration of time series into global datasets. This happens typically at the admin level. Time series are unique ACROSS datasets.</p></li>
<li><p>collection = playlist like user specific bookmarks. A time series can part of multiple collections, users can have multiple collections. The purpose of collections is to be able to re-visit a selection of time series after updates etc, e.g., to update time series visualizations.</p></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="../reference/db_collection_add.html">db_collection_add</a></span>(con, </a>
<a class="sourceLine" id="cb9-2" data-line-number="2">                  <span class="dt">collection_name =</span> <span class="st">"demo_collect"</span>,</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">                  <span class="dt">keys =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ch.zrh_airport.arrival.total"</span>,</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">                           <span class="st">"AirPassengers"</span>),</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">                  <span class="dt">description =</span> <span class="st">"Flying Around Now and Then"</span>,</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">                  <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a></code></pre></div>
<p>You can remove keys from a collection using <a href="">db_collection_remove()</a> and delete an entire collection with <a href="">db_collection_delete()</a>.</p>
</div>
<div id="advanced-meta-information" class="section level2">
<h2 class="hasAnchor">
<a href="#advanced-meta-information" class="anchor"></a>Advanced Meta Information</h2>
<p>Context aware data description is one of the core aims of {timeseriesdb}. Meta information done properly can quickly become a complex topic: descriptions can be assigned at different levels. Descriptions can be language agnostic or language specific. Moreover with versioned time series descriptions can also be specific to a particular version of a time series.</p>
<div id="multi-language-data-descriptions" class="section level3">
<h3 class="hasAnchor">
<a href="#multi-language-data-descriptions" class="anchor"></a>Multi Language Data Descriptions</h3>
<p>Simply create meta information objects for each language, similar to the fashion we’ve seen in the <a href="">Basic Usage</a> article. Meta information objects can hold descriptions for one or more time series. Make sure you do NOT change the language within one object.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">de &lt;-<span class="st"> </span><span class="kw">create_tsmeta</span>(</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">  <span class="dt">ch.zrh_airport.arrival.total =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">    <span class="dt">provider =</span> <span class="st">"Flughafen Zürich",</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="st">    description = "</span>Eine deutschsprachige Beschreibung<span class="st">"</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="st">  )</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="st">)</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="st">en &lt;- create_tsmeta(</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="st">  ch.zrh_airport.arrival.total = list(</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="st">    provider = "</span>Zurich Airport<span class="st">",</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="st">    description = "</span>An English speaking description<span class="st">"</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="st">  )</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="st">)</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="st">db_store_ts_metadata(con,</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="st">                     metadata = de,</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="st">                     valid_from = Sys.Date(),</span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="st">                     locale = "</span>de<span class="st">",</span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="st">                     schema = "</span>tsdb_test<span class="st">")</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="st">db_store_ts_metadata(con,</span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="st">                     metadata = en,</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="st">                     valid_from = Sys.Date(),</span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="st">                     locale = "</span>en<span class="st">",</span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="st">                     schema = "</span>tsdb_test<span class="st">")</span></a></code></pre></div>
<p>Retrieving the information is just as simple, let’s get the English description…</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="../reference/db_read_ts_metadata.html">db_read_ts_metadata</a></span>(con, <span class="st">"ch.zrh_airport.arrival.total"</span>,</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">                    <span class="dt">locale =</span> <span class="st">"en"</span>,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">                    <span class="dt">valid_on =</span> <span class="kw"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(),</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">                    <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a></code></pre></div>
</div>
<div id="levels-of-assignment" class="section level3">
<h3 class="hasAnchor">
<a href="#levels-of-assignment" class="anchor"></a>Levels of Assignment</h3>
<p>Meta descriptions can be assigned at various levels. Descriptions either belong to a <em>dataset</em>, to a <em>time series</em> or two a <em>vintage of a time series</em>. Meta information is only loosely coupled to vintages of time series, because in most usecases meta descriptions do not change every time there is a data revision. So by simply not updating unchanged descriptions when data are revised / updated, we allow descriptions to last for multiple versions of a time series.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="../reference/db_get_metadata_validity.html">db_get_metadata_validity</a></span>(con, <span class="st">"ch.zrh_airport.arrival.total"</span>, </a>
<a class="sourceLine" id="cb12-2" data-line-number="2">                         <span class="dt">locale =</span> <span class="st">"de"</span>,</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">                         <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a></code></pre></div>
<p>helps to get and overview find out since when meta information is valid. Note that dataset level meta information can currently only be assigned when the dataset is created and is not versioned.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#starting-point">Starting Point</a></li>
      <li><a href="#versioning-of-time-series-vintages">Versioning of Time Series (Vintages)</a></li>
      <li><a href="#datasets">Datasets</a></li>
      <li><a href="#release-management">Release Management</a></li>
      <li><a href="#collections">Collections</a></li>
      <li><a href="#advanced-meta-information">Advanced Meta Information</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by 'Matthias Bannert'.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
