<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced Usage • timeseriesdb</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Advanced Usage">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">timeseriesdb</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01_basic_usage.html">Basic Usage</a>
    </li>
    <li>
      <a href="../articles/a02_advanced_usage.html">Advanced Usage</a>
    </li>
    <li>
      <a href="../articles/developer_doc.html">timeseriesdb Developer Documentation</a>
    </li>
    <li>
      <a href="../articles/installation_guide.html">Installation Guide</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mbannert/timeseriesdb">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Advanced Usage</h1>
                        <h4 class="author">Matthias Bannert and Severin Thöni</h4>
            
            <h4 class="date">2020-07-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mbannert/timeseriesdb/blob/master/vignettes/a02_advanced_usage.Rmd"><code>vignettes/a02_advanced_usage.Rmd</code></a></small>
      <div class="hidden name"><code>a02_advanced_usage.Rmd</code></div>

    </div>

    
    
<div id="starting-point" class="section level2">
<h2 class="hasAnchor">
<a href="#starting-point" class="anchor"></a>Starting Point</h2>
<p>We assume you are past the basics and R, {timeseriesdb} and PostgreSQL are up and running. (<em>For the remainder of this guide we assume PostgreSQL runs on a local docker container accessible via port 1111.</em>)</p>
</div>
<div id="datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#datasets" class="anchor"></a>Datasets</h2>
<p>In {timeseriesdb}, all time series have to be part of a dataset. If the user stores a time series w/o specifying a dataset that series is assigned to the ‘default’ dataset. Datasets allow to group data and store data descriptions at the dataset level. Also, datasets come in handy for admin operations like deletion of an entire dataset.</p>
<p>Let’s create a new dataset!</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(kofdata)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">arr &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/kofdata/man/get_time_series.html">get_time_series</a></span>(<span class="st">"ch.zrh_airport.arrival.total"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">dep &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/kofdata/man/get_time_series.html">get_time_series</a></span>(<span class="st">"ch.zrh_airport.departure.total"</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw"><a href="../reference/store_time_series.html">store_time_series</a></span>(con, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(arr,dep), <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw"><a href="../reference/db_create_dataset.html">db_create_dataset</a></span>(con, <span class="st">"ch.zrh_airport"</span>,</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">                  <span class="dt">set_description =</span> <span class="st">"Arrivals and Departures ZH Airport"</span>,</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">                  <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co"># see, the new dataset is there... </span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="kw">db_list_datasets</span>(con, <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a></code></pre></div>
<p>Apparently, the dataset is empty. We need to assign some time series first. Make sure the time series you want to register to a set are actually around. Unlike <code>store_time_series</code> assigning series to a dataset is <em>not</em> a vintage level operation, it applies to all versions of a series. This is why time series are assigned to the ‘default’ schema at first when they are stored and can be moved later on.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="../reference/db_assign_dataset.html">db_assign_dataset</a></span>(con,</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">                  <span class="dt">ts_keys =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ch.zrh_airport.arrival.total"</span>,</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">                              <span class="st">"ch.zrh_airport.departure.total"</span>),</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">                  <span class="dt">set_name =</span> <span class="st">"ch.zrh_airport"</span>,</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">                  <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a></code></pre></div>
<p><strong>Note</strong> that there is no such thing as remove time series from dataset. Either you delete a time series entirely or you assign it to another dataset. Think of a registry similar to a software registry.</p>
<p>To see all keys registered in a dataset simply call:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="../reference/db_get_dataset_keys.html">db_get_dataset_keys</a></span>(con, <span class="st">"ch.zrh_airport"</span>, <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a></code></pre></div>
<p>To do the opposite, that is, find out which dataset series are assigned to, run:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/db_get_dataset_id.html">db_get_dataset_id</a></span>(con, <span class="st">"ch.zrh_airport.arrival.total"</span>,</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">                  <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a></code></pre></div>
</div>
<div id="release-management" class="section level2">
<h2 class="hasAnchor">
<a href="#release-management" class="anchor"></a>Release Management</h2>
<p>A new feature introduced with {timeseriesdb} 1.0 is its support for release management. In official and economic statistics, data are usually updated periodically. Often data are released on release date known in advance. Data may be available inside an institution but only be released later on. In order to facilitate the publication process.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">db_create_release</span>(con,</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">                  <span class="dt">id =</span> <span class="st">"jul_2020_air"</span>,</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">                  <span class="dt">datasets =</span> <span class="st">"ch.zrh_airport"</span>,</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">                  <span class="dt">title =</span> <span class="st">"Airport Data from Zurich Airport"</span>,</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">                  <span class="dt">release_date =</span> <span class="st">"2020-07-08"</span>,</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">                  <span class="dt">target_year =</span> <span class="dv">2020</span>,</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">                  <span class="dt">target_period =</span> <span class="dv">7</span>,</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">                  <span class="dt">target_frequency =</span> <span class="dv">12</span>,</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">                  <span class="dt">note =</span> <span class="st">"Just a test release"</span>,</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">                  <span class="dt">schema =</span> <span class="st">"tsdb_test"</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11">                  )</a></code></pre></div>
<p>In {timeseriesdb}, releases have an id which uniquely identifies the release. We recommend to choose a short human readable text identifier. Releases relate to a dataset and therefore are assigned at the dataset level. This is a good reason to make use of the datasets features as opposed to storing all series in the default set. There is a target year and target period because the release date itself may not safely identify the period it relates to (assume there July data get released at the beginning of August).</p>
<p>To list all releases, simply run the below code. The default is not to show releases in the past.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">db_list_releases</span>(con, <span class="dt">include_past =</span> T, <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a></code></pre></div>
<p>Cancelling a future release is simply a matter of calling <a href="">db_cancel_release()</a>. Cancellation of past releases is not possible.</p>
</div>
<div id="collections" class="section level2">
<h2 class="hasAnchor">
<a href="#collections" class="anchor"></a>Collections</h2>
<p>Collections are another concept introduced in v1.0. Collections are user specific compositions of time series identifiers. Users of earlier versions of time series may think of this functionality as ‘sets’. To avoid any confusion, let’s be clear about the new terminology here:</p>
<ul>
<li><p>datasets = registration of time series into global datasets. This happens typically at the admin level. Time series are unique ACROSS datasets.</p></li>
<li><p>collection = playlist like user specific bookmarks. A time series can part of multiple collections, users can have multiple collections. The purpose of collections is to be able to re-visit a selection of time series after updates etc, e.g., to update time series visualizations.</p></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/db_collection_add.html">db_collection_add</a></span>(con, </a>
<a class="sourceLine" id="cb7-2" data-line-number="2">                  <span class="dt">collection_name =</span> <span class="st">"demo_collect"</span>,</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">                  <span class="dt">keys =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ch.zrh_airport.arrival.total"</span>,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">                           <span class="st">"AirPassengers"</span>),</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">                  <span class="dt">description =</span> <span class="st">"Flying Around Now and Then"</span>,</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">                  <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a></code></pre></div>
<p>You can remove keys from a collection using <a href="">db_collection_remove()</a> and delete an entire collection with <a href="">db_collection_delete()</a>.</p>
</div>
<div id="advanced-meta-information" class="section level2">
<h2 class="hasAnchor">
<a href="#advanced-meta-information" class="anchor"></a>Advanced Meta Information</h2>
<div id="multi-language-data-descriptions" class="section level3">
<h3 class="hasAnchor">
<a href="#multi-language-data-descriptions" class="anchor"></a>Multi Language Data Descriptions</h3>
</div>
<div id="levels-of-assignment" class="section level3">
<h3 class="hasAnchor">
<a href="#levels-of-assignment" class="anchor"></a>Levels of Assignment</h3>
</div>
</div>
<div id="versioning-of-time-series-vintages" class="section level2">
<h2 class="hasAnchor">
<a href="#versioning-of-time-series-vintages" class="anchor"></a>Versioning of Time Series (Vintages)</h2>
</div>
<div id="access-levels-and-rights-management" class="section level2">
<h2 class="hasAnchor">
<a href="#access-levels-and-rights-management" class="anchor"></a>Access Levels and Rights Management</h2>
</div>
<div id="hygenie-and-maintenance" class="section level2">
<h2 class="hasAnchor">
<a href="#hygenie-and-maintenance" class="anchor"></a>Hygenie and Maintenance</h2>
</div>
<div id="remove" class="section level2">
<h2 class="hasAnchor">
<a href="#remove" class="anchor"></a>Remove</h2>
<p>{timeseriesdb} keeps track of different versions of a time series. This feature was designed with regular releases of data in mind. In official and economic statistics, releases do not simply mean to append another observation at end of time series. Seasonal adjustment and other filters as well data corrections cause revisions of a time series. In order to keep research, e.g., forecasts reproducible, it is important to archive all versions of a time series. Doing so, allows to assess forecast performance and makes sure the state of information at the time the forecast was made can be reproduced.</p>
<p>{timeseriesdb} allows to store one version of a time series per day, i.e., series</p>
</div>
<div id="collections-aka-playlists" class="section level2">
<h2 class="hasAnchor">
<a href="#collections-aka-playlists" class="anchor"></a>Collections (aka playlists)</h2>
</div>
<div id="datasets-1" class="section level2">
<h2 class="hasAnchor">
<a href="#datasets-1" class="anchor"></a>Datasets</h2>
<p>In {timeseriesdb} <em>every</em> time series belongs to a dataset. If no dataset is specified when a time series is stored, the series automagically gets assigned to the <em>default</em> dataset.</p>
<p>The idea behind datasets is to group time series according to their source and allow for group level data description. The following helpers help you to explore which keys are in a given set and which keys are in which set.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/db_get_dataset_keys.html">db_get_dataset_keys</a></span>(con, <span class="dt">set_name =</span> <span class="st">"default"</span>,</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">                    <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="kw"><a href="../reference/db_get_dataset_id.html">db_get_dataset_id</a></span>(con, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"AirPassengers"</span>, <span class="st">"JohnsonJohnson"</span>),</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">                  <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a></code></pre></div>
<p>You can easily add new datasets. Note though, that dataset are not user specific, but global groups. The user specific analog to sets is called collection in will be described later on.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="../reference/db_create_dataset.html">db_create_dataset</a></span>(con, <span class="st">"stocks"</span>,</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">                  <span class="dt">set_description =</span> <span class="st">"Stock market returns."</span>,</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">                  <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a></code></pre></div>
<p>Once a set is created you can move existing series to that set.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/db_assign_dataset.html">db_assign_dataset</a></span>(con,<span class="st">"JohnsonJohnson"</span>,<span class="st">"stocks"</span>,</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">                  <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw"><a href="../reference/db_get_dataset_id.html">db_get_dataset_id</a></span>(con, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"AirPassengers"</span>, <span class="st">"JohnsonJohnson"</span>), <span class="dt">schema =</span> <span class="st">"tsdb_test"</span>)</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#starting-point">Starting Point</a></li>
      <li><a href="#datasets">Datasets</a></li>
      <li><a href="#release-management">Release Management</a></li>
      <li><a href="#collections">Collections</a></li>
      <li><a href="#advanced-meta-information">Advanced Meta Information</a></li>
      <li><a href="#versioning-of-time-series-vintages">Versioning of Time Series (Vintages)</a></li>
      <li><a href="#access-levels-and-rights-management">Access Levels and Rights Management</a></li>
      <li><a href="#hygenie-and-maintenance">Hygenie and Maintenance</a></li>
      <li><a href="#remove">Remove</a></li>
      <li><a href="#collections-aka-playlists">Collections (aka playlists)</a></li>
      <li><a href="#datasets-1">Datasets</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by 'Matthias Bannert'.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
